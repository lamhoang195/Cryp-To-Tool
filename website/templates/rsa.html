{% extends "block.html" %}

{% block title %}RSA Encrypt System {% endblock %}
{% block page_title %}RSA Encrypt System {% endblock %}
{% block breadcrumb %}RSA Encrypt System {% endblock %}

{% block content %}


        {% include 'head.html' %}

        
        <div class="cryptosystem-container">
            <h1>RSA Encryption - Step by Step Guide</h1>
            <p>Learn how to encrypt and decrypt using the RSA algorithm with this interactive tool.</p>
        
            <h2>Step 1: Choose Prime Numbers</h2>
            <p>Start by selecting two prime numbers <var>p</var> and <var>q</var>:</p>
            <div class="calculation-section">
                <div class="input-item">
                    <label for="p"><var>p</var> = </label>
                    <input type="text" id="p" placeholder="Enter a prime number" value="{{p}}">
                </div>
                <div class="input-item">
                    <label for="q"><var>q</var> = </label>
                    <input type="text" id="q" placeholder="Enter a prime number" value="{{q}}">
                </div>
            </div>
            <p>Or you can generate prime numbers with number of bits you want from 1 to 2048:</p>
            <div>   
                <label for="Number of bits">Number of bits</label>
                <input type="number" id="bits" placeholder="Enter number of bits">
                <button class = "generate-prime btn" type="submit">Generate Prime Number</button>
            </div>
            <div>
                <button class="rsa-submit btn" type="submit">Submit</button>
            </div>
        
            <h2>Step 2: Calculate Key Values</h2>
            <p>Follow these calculations to generate the keys:</p>
            <div class="calculation-section">
                <p>Calculate <var>n</var> by multiplying <var>p</var> and <var>q</var>:</p>
                <p><var>n</var> = <var>p</var> × <var>q</var></p>
                <p id="n-value">Result: <var>n</var> = </p>
        
                <p>To calculate the further values <var>e</var> and <var>d</var> the Euler phi function <var>ϕ</var> is used.
                    It calculates how many numbers coprime to <var>n</var> are there, which are not larger than <var>n</var>. </p>
                <p><var>ϕ(n)</var> = (<var>p</var> - 1) × (<var>q</var> - 1)</p>
                <p id="phi-value"><var>ϕ</var>(<var>n</var>) = </p>
        
                <p>Choose a number <var>e</var> that is coprime to <var>φ</var>(<var>n</var>) and smaller than it.</p>
                <div class="input-item">
                    <label for="e"> <var>e</var> = </label>
                    <input type="text" id="e" placeholder="Enter number" value={{e}}>
                </div>
                <p>Or you can generate prime numbers with number of bits you want from 1 to 4096:</p>
                    <div>   
                        <label for="Number of bits e">Number of bits e</label>
                        <input type="number" id="bitse" placeholder="Enter number of bits e">
                        <button class = "generate-prime-e btn" type="submit">Generate Prime Number</button>
                    </div>
                <div>
                    <button class="generate-keys btn" type="submit">Generate Private Key</button>
                </div>
        
                <p>The number <var>d</var> is the multiplicative inverse to e</p>
                <p>Expressed in formulas, the following must apply:</p>
                <p>Find <var>d</var> such that (<var>d</var> × <var>e</var>) mod <var>ϕ(n)</var> = 1:</p>
                <p id="d-value">Result: <var>d</var> = </p>

                <div>
                    <p id="public-key">Public key: <var>(n, e)</var> = </p>
                </div>
                <div>
                    <p id="private-key">Private key: <var>(n, d)</var> = </p>
                </div>
            </div>
        
            <h2>Step 3: Encrypt</h2>
            <p>To encrypt a number <var>m</var> to ciphertext <var>c</var> the following formula is applied.</p>
            <div class="calculation-section">
                <p>It uses the numbers of the public key:</p>
                <p><var>c</var> = (<var>m</var> ^ <var>e</var>) mod <var>n</var></p>
                <p>RSA encrypts only numbers. These must be greater-equal 0 and less than n.</p>
                <p>So you need convert from string to int:</p>
                <div>
                    <label for="plain"></label>
                    <input type="text" id="plain" placeholder="Type your plaintext">
                    <button class = "convert btn" type="submit">Convert</button>
                    <p id="plaintext">Plaintext: </p>
                </div>
                <label for="m"> <var>m</var> = </label>
                <input type="number" id="m" placeholder="Enter message m">
                <div>
                    <button class="encrypt btn" type="submit">Encrypt</button>
                </div>
                <p id="c-value">Encrypted: <var>c</var> = </p>
            </div>

            <h2>Step 4: Decrypt</h2>
            <p>For decryption the inverse formula is applied.</p>
            <div class="calculation-section">
                <p>It uses the numbers of the private key:</p>
                <p><var>m</var> = (<var>c</var> ^ <var>d</var>) mod <var>n</var></p>
                <label for="c-decrypt"> <var>c</var> = </label>
                <input type="text" id="c-decrypt" placeholder="Enter ciphertext c">
                <div>
                    <button class="decrypt btn" type="submit">Decrypt</button>
                </div>
                <p id="m-decrypt-value">Decrypted: <var>m</var> = </p>
            </div>    
        </div>
        <script src="static/js/rsa.js"></script>
        

        {% include 'footer.html' %}
{%endblock%}